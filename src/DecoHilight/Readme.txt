=============================================================================
【 名  称 】 強調表示などの定義ファイルを装飾  Decoration Hilight
【動作環境】 秀丸エディタ ver 8以降 / HmJre.dll ver 2.03以降
【 作成日 】 2009.07.20
【 更新日 】 2020.06.02
【 製作者 】 eamat.
【  URL   】 https://github.com/eamat-dot/DecoHilight
=============================================================================
.■概要
    秀丸からエクスポートした強調表示などの定義ファイル(*.hilight)に装飾を
    ほどこして視覚的に分かりやすくします。
    ・編集中のファイルの設定を hilightファイル形式で 新規秀丸に書き出します。
    ・フラグ解説などの説明文をコメントとして付加しします。
    ・hilightファイル自身をその定義通りの色で描写します。

    hilightファイルを直接再編集しようと試みるもののフラグ類の意味がわからず
    挫折することが重なり面倒になったので作ってみました。

.■動作環境
    秀丸エディタ                ver 8 以降 (必須)
    正規表現DLL      HmJre.dll  ver 2.03 以降 (必須)

.■開発および確認環境
   Windows10 x64 Pro 1909
   秀丸エディタ ver 8.91 32bit版 (HmJre.dll 5.06)

.■ファイル構成
    DecoHilight.mac                     : マクロ本体
    DecoHilight\ReadMe.txt              : このファイル
    DecoHilight\DecoHilight.ini         : マクロ動作設定用 ini
    DecoHilight\ColorlingHilight.mac    : .hilight カラーリングマクロ
    DecoHilight\ColorlingHilight.hilight: (ColorlingHilight.mac用)
    DecoHilight\CommentingHilight.mac   : .hilight コメント挿入マクロ
    DecoHilight\SectionHeader\*.txt     : 挿入用項目別説明テキスト

  ※ カラーリングマクロ および コメント挿入マクロ は単体でも動作可能です。
    ・カラーリングマクロ  必要ファイル
    ColorlingHilight.mac     : マクロ本体
    ColorlingHilight.hilight : 強調表示の強調ファイル

    ・コメント挿入マクロ  必要ファイル
    CommentingHilight.mac   : .hilight コメント挿入マクロ
    DecoHilight.ini         : マクロ動作設定用 ini
    SectionHeader\*.txt     : 挿入用項目別説明テキスト

.■インストール、アンインストール
    DecoHilight.mac と \DecoHilight 以下のファイルを マクロフォルダ もしくは
    任意のフォルダにコピーする。
    DecoHilight.macを 秀丸上でマクロ登録する。カラーリングやコメント挿入を単体で
    使いたい場合は ColorlingHilight.mac CommentingHilight.mac も登録する。

    アンインストール時は秀丸上でマクロ登録を解除の上、全てのファイルを削除して
    下さい。レジストリへの書込みはしていません。

.■使いかた
    装飾したい hilightファイル、もしくは定義を見たいファイルタイプのファイルを
    秀丸で開き、DecoHilight.macを実行します。
    編集中のファイルが hilightファイル形式のテキストであればそのまま、
    そうでない場合は、hilightファイル形式で新規秀丸に設定が書き出されてから
    コメント挿入とカラーリング装飾が行われます。

..◆ コメント挿入の動作仕様

    強調表示、カラーセットなどの各項目ごとにフォーマットの説明を付けられます。
    行またはブロックごとにフラグの意味を挿入します。
    (項目説明、ブロックごと説明のON/OFFは DecoHilight.ini で指定できます)
    コメントが付加された状態でも.hilightファイルとして保存すればそのまま秀丸に
    読み込み(インポート)が可能です。

    既にコメントされた行がある状態で実行するとメニューが出て動作を聞いてきます。
     1. コメント除去
        説明文的なコメントを及びその付近の改行を削除して終了します。
        // 9,hoge
        のような有効行を一時的にコメントアウトしただけの行は極力残します。

     2. コメントを除去して続行
        1の要領でコメント削除後に新たにコメントを挿入します。

     3. そのまま続行
        現在のコメントはそのままでコメントを挿入します。
        既存のコメント行と文字列比較して重複コメントはできるだけ
        発生しないようにしています。(そのかわりとても遅いです。)
        (strstrの部分一致で見てるので行頭(//のすぐ後)や行末であれば
        手動で任意の説明を追加しても同一行とみなしてくれるかも)

        手動でフラグが編集した場合とか説明内容が変化したときは重複します。
        (正しくない説明行だけを削除する機能はないです。)

     4. キャンセル
        何もしないで終了します。

    コメント含めほぼ全行を舐めて見ているため、動作は著しく遅いです。

..◆ カラーリングの動作仕様
    loadhilight でファイルタイプ別の設定を一時的に変更して、秀丸上での見た目を
    hilightファイルの設定通りにします。また、カラーセットや複数行コメントなどを
    カラーマーカーで色付けします。
    ※ カラーリングはファイルを閉じて開き直すと元に戻ります。
     (意図的に[強制的に保存]を行わない限りは秀丸の設定には影響しないです)
    ※ カラーセットの含まれない hilightファイル上で実行した場合は、
       [.HILIGHTの設定] のデザインで塗られます。

    カラーリングされている状態で再度実行するとメニューが出て動作を聞いてきます。
    メニューから[1.リセット]を選ぶとファイルを閉じずに表示をリセットできます。

.■設定
    iniファイル (DecoHilight.ini)で動作設定を指定できます。
    設定項目および記述のしかたは iniを見て下さい。
    ・強調ファイル出力設定 (DecoHilight.mac)
      hilightファイルじゃないファイル上で DecoHilight を実行したときに
      書き出しする 項目種類を指定できます。

    ・コメント 挿入用 項目設定 (CommentingHilight.mac)
      行ごとの補足コメントをつけるかどうかを項目別に指定できます。
      各項目の冒頭に付けるフォーマット説明を挿入するかどうかを項目別に指定できます
      各項目の冒頭に付けるフォーマット説明のテンプレートファイルを指定できます。
      テンプレートファイルはただのテキストファイルです。
      お好みで書き換えてご利用ください。

    ・出力されるコメントの一部名称を指定できるかも
      将来カラーセットやスタイルが増えてもini書き換えで対応できるかも。

    具体的な指定のしかたは DecoHilight.ini を直接見て下さい。

.■注意事項等
    本マクロの挙動および SectionHeader 内の項目説明は、私(eamat.) が独自に調べて
    適当に仕上げたもので情報が欠けていたり間違ってたりする可能性があります。
    また将来秀丸のバージョンアップでフォーマットに仕様が追加された場合誤動作を
    引き起こすかもしれません。
    本マクロが原因で致命的な状態が発生しても 当方私は責任を負えません。
    ご自身の責任においてご利用ください。

.■分かっている問題点
    HmJre.dll での正規表現検索を多用しているため、ファイルが大きすぎると
    HeapAllocでエラーで異常終了する可能性があります。
    また、秀丸エディタ ver 7.11 に同梱の HmJre.dll (v1.92)はメモリリークの
    不具合があるため、なるべく新しい HmJre.dll (ver 2.03以降)を用意して下さい

    (※ マクロ作成当時 秀丸ver 7.11のころの話なので今は改善されてるかもしれません）

.■ライセンス
    このマクロのライセンスはMITです。ソース改変はご自由に。
    再配布の際は下の3行をreadmeかソースのどこかに書いとけばOKなようです。

    Copyright (c) 2020 eamat.
    Released under the MIT license
    https://ja.osdn.net/projects/opensource/wiki/licenses%2FMIT_license

.■履歴
  1.0.0  2009.07.20    作成
  1.0.1  2017.10.28    微修正
  1.1.0  2020.05.31    公開、Hilightファイルの仕様変更に合わせた微調整

.■その他
   10年前に書くだけ書いて放置してあったreadmeのままなのでフォーマットが古くてすいません。
